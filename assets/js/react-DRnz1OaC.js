import{r as ce}from"./rolldown-runtime-CzF6_L4l.js";import{a as ee,c as U,l as de,o as _,s as ae,u as he}from"./admin-components-D24Ek_cO.js";import{a as fe,i as d,n as i,r as y,t as l}from"./classPrivateFieldSet2-DTU-rhuG.js";var pe=ce(he(),1);ae();de();var Y,Z="https://player.twitch.tv",ve=/(?:www\.|go\.)?twitch\.tv\/(?:videos?\/|\?video=)(\d+)($|\?)/,me=/(?:www\.|go\.)?twitch\.tv\/([a-zA-Z0-9_]+)($|\?)/,te={IDLE:"Idle",READY:"Ready",BUFFERING:"Buffering",PLAYING:"Playing",ENDED:"Ended"},S={DISABLE_CAPTIONS:0,ENABLE_CAPTIONS:1,PAUSE:2,PLAY:3,SEEK:4,SET_CHANNEL:5,SET_CHANNEL_ID:6,SET_COLLECTION:7,SET_QUALITY:8,SET_VIDEO:9,SET_MUTED:10,SET_VOLUME:11};function se(e,n={}){const t={src:le(e,n),frameborder:"0",width:"100%",height:"100%",allow:"accelerometer; fullscreen; autoplay; encrypted-media; picture-in-picture;",sandbox:"allow-modals allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox",scrolling:"no"};return n.config&&(t["data-config"]=JSON.stringify(n.config)),`
    <style>
      :host {
        display: inline-block;
        min-width: 300px;
        min-height: 150px;
        position: relative;
      }
      iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }
      :host(:not([controls])) {
        pointer-events: none;
      }
    </style>
    <iframe${we(t)}></iframe>
  `}function le(e,n){var t;if(!e.src)return;const r=e.src.match(ve),u=e.src.match(me),m=_({parent:(t=globalThis.location)==null?void 0:t.hostname,controls:e.controls===""?null:!1,autoplay:e.autoplay===""?null:!1,muted:e.muted,preload:e.preload},n.config);return r?`${Z}/?video=v${r[1]}&${ne(m)}`:u?`${Z}/?channel=${u[1]}&${ne(m)}`:""}var H=new WeakMap,R=new WeakMap,b=new WeakMap,o=new WeakMap,G=new WeakMap,D=new WeakMap,$=new WeakMap,B=new WeakMap,A=new WeakMap,M=new WeakMap,x=new WeakMap,J=new WeakMap,E=new WeakSet,k=class extends((Y=globalThis.HTMLElement)!==null&&Y!==void 0?Y:class{}){constructor(){var e;super(),e=this,fe(this,E),U(this,"loadComplete",new ie),d(this,H,void 0),d(this,R,void 0),d(this,b,void 0),d(this,o,{}),d(this,G,0),d(this,D,!1),d(this,$,1),d(this,B,!this.autoplay),d(this,A,!1),d(this,M,0),d(this,x,null),d(this,J,(function(){var n=ee(function*(t){var r,u,m,P;if(!i(b,e).contentWindow)return;const{data:h,source:N}=t;if(N===i(b,e).contentWindow){if(h.namespace==="twitch-embed")yield new Promise(w=>setTimeout(w,10)),h.eventName==="ready"?(e.dispatchEvent(new Event("loadcomplete")),e.loadComplete.resolve(),l(M,e,1),e.dispatchEvent(new Event("loadedmetadata"))):h.eventName==="seek"?(l(A,e,!0),e.dispatchEvent(new Event("seeking"))):h.eventName==="playing"?(i(A,e)&&(l(A,e,!1),e.dispatchEvent(new Event("seeked"))),l(M,e,3),e.dispatchEvent(new Event("playing"))):e.dispatchEvent(new Event(h.eventName));else if(h.namespace==="twitch-embed-player-proxy"&&h.eventName==="UPDATE_STATE"){const w=i(o,e).duration,C=i(o,e).currentTime,g=i(o,e).volume,I=i(o,e).muted,W=(u=(r=i(o,e).stats)==null?void 0:r.videoStats)==null?void 0:u.bufferSize;l(o,e,_(_({},i(o,e)),h.params)),w!==i(o,e).duration&&e.dispatchEvent(new Event("durationchange")),C!==i(o,e).currentTime&&e.dispatchEvent(new Event("timeupdate")),(g!==i(o,e).volume||I!==i(o,e).muted)&&(i(o,e).volume!==void 0&&l($,e,i(o,e).volume),i(o,e).muted!==void 0&&l(D,e,i(o,e).muted),e.dispatchEvent(new Event("volumechange"))),W!==((P=(m=i(o,e).stats)==null?void 0:m.videoStats)==null?void 0:P.bufferSize)&&e.dispatchEvent(new Event("progress"))}}});return function(t){return n.apply(this,arguments)}})()),y(E,this,ge).call(this,"config")}get config(){return i(x,this)}set config(e){l(x,this,e)}load(){var e=this;return ee(function*(){if(i(H,e))return;e.shadowRoot||e.attachShadow({mode:"open"});const n=!i(R,e);if(i(R,e)&&(e.loadComplete=new ie),l(R,e,!0),yield l(H,e,Promise.resolve()),l(H,e,null),l(M,e,0),e.dispatchEvent(new Event("emptied")),!e.src){e.shadowRoot.innerHTML="",globalThis.removeEventListener("message",i(J,e));return}e.dispatchEvent(new Event("loadstart"));let t=e.shadowRoot.querySelector("iframe");const r=Ee(e.attributes);n&&t&&l(x,e,JSON.parse(t.getAttribute("data-config")||"{}")),(!(t!=null&&t.src)||t.src!==le(r,e))&&(e.shadowRoot.innerHTML=se(r,e),t=e.shadowRoot.querySelector("iframe")),l(b,e,t),globalThis.addEventListener("message",i(J,e))})()}attributeChangedCallback(e,n,t){if(n!==t)switch(e){case"src":case"controls":this.load();break}}getVideoPlaybackQuality(){return i(o,this).stats.videoStats}get src(){return this.getAttribute("src")}set src(e){this.setAttribute("src",e)}get readyState(){return i(M,this)}get seeking(){return i(A,this)}get buffered(){var e,n,t;return be(0,(e=(t=(n=i(o,this).stats)==null?void 0:n.videoStats)==null?void 0:t.bufferSize)!==null&&e!==void 0?e:0)}get paused(){return i(o,this).playback?i(o,this).playback===te.IDLE:i(B,this)}get ended(){return i(o,this).playback?i(o,this).playback===te.ENDED:!1}get duration(){var e;return(e=i(o,this).duration)!==null&&e!==void 0?e:NaN}get autoplay(){return this.hasAttribute("autoplay")}set autoplay(e){this.autoplay!=e&&this.toggleAttribute("autoplay",!!e)}get controls(){return this.hasAttribute("controls")}set controls(e){this.controls!=e&&this.toggleAttribute("controls",!!e)}get currentTime(){return i(o,this).currentTime?i(o,this).currentTime:i(G,this)}set currentTime(e){l(G,this,e),this.loadComplete.then(()=>{y(E,this,L).call(this,S.SEEK,e)})}get defaultMuted(){return this.hasAttribute("muted")}set defaultMuted(e){this.toggleAttribute("muted",!!e)}get loop(){return this.hasAttribute("loop")}set loop(e){this.toggleAttribute("loop",!!e)}get muted(){return i(D,this)}set muted(e){l(D,this,e),this.loadComplete.then(()=>{y(E,this,L).call(this,S.SET_MUTED,e)})}get volume(){return i($,this)}set volume(e){l($,this,e),this.loadComplete.then(()=>{y(E,this,L).call(this,S.SET_VOLUME,e)})}get playsInline(){return this.hasAttribute("playsinline")}set playsInline(e){this.toggleAttribute("playsinline",!!e)}play(){l(B,this,!1),y(E,this,L).call(this,S.PLAY)}pause(){l(B,this,!0),y(E,this,L).call(this,S.PAUSE)}};function L(e,n){if(!i(b,this).contentWindow)return;const t={eventName:e,params:n,namespace:"twitch-embed-player-proxy"};i(b,this).contentWindow.postMessage(t,Z)}function ge(e){if(Object.prototype.hasOwnProperty.call(this,e)){const n=this[e];delete this[e],this[e]=n}}U(k,"getTemplateHTML",se);U(k,"shadowRootOptions",{mode:"open"});U(k,"observedAttributes",["autoplay","controls","loop","muted","playsinline","preload","src"]);function Ee(e){let n={};for(let t of e)n[t.name]=t.value;return n}function we(e){let n="";for(const t in e){const r=e[t];r===""?n+=` ${K(t)}`:n+=` ${K(t)}="${K(`${r}`)}"`}return n}function K(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/`/g,"&#x60;")}function ne(e){return String(new URLSearchParams(ye(e)))}function ye(e){let n={};for(let t in e){let r=e[t];r===!0||r===""?n[t]=!0:r===!1?n[t]=!1:r!=null&&(n[t]=r)}return n}var ie=class extends Promise{constructor(e=()=>{}){let n,t;super((r,u)=>{e(r,u),n=r,t=u}),this.resolve=n,this.reject=t}};function be(e,n){return Array.isArray(e)?Q(e):e==null||n==null||e===0&&n===0?Q([[0,0]]):Q([[e,n]])}function Q(e){return Object.defineProperties(e,{start:{value:n=>e[n][0]},end:{value:n=>e[n][1]}}),e}globalThis.customElements&&!globalThis.customElements.get("twitch-video")&&globalThis.customElements.define("twitch-video",k);var _e=k;ae();var Te=new Set(["style","children","ref","key","suppressContentEditableWarning","suppressHydrationWarning","dangerouslySetInnerHTML"]),Se={className:"class",htmlFor:"for"};function ue(e){return e.toLowerCase()}function re(e){if(typeof e=="boolean")return e?"":void 0;if(typeof e!="function"&&!(typeof e=="object"&&e!==null))return e}function Ae({react:e,tagName:n,elementClass:t,events:r,displayName:u,defaultProps:m,toAttributeName:P=ue,toAttributeValue:h=re}){const N=Number.parseInt(e.version)>=19,w=e.forwardRef((C,g)=>{var I,W;const f=e.useRef(null),j=e.useRef(new Map),F={},X={},p={},O={};for(const[a,s]of Object.entries(C)){var z,q;if(Te.has(a)){p[a]=s;continue}const c=P((z=Se[a])!==null&&z!==void 0?z:a);if(t.prototype&&a in t.prototype&&!(a in((q=(I=globalThis.HTMLElement)==null?void 0:I.prototype)!==null&&q!==void 0?q:{}))&&!((W=t.observedAttributes)!=null&&W.some(T=>T===c))){O[a]=s;continue}if(a.startsWith("on")){F[a]=s;continue}const v=h(s);c&&v!=null&&(X[c]=String(v),N||(p[c]=v)),c&&N&&(v!==re(s)?p[c]=v:p[c]=s)}if(typeof window!="undefined"){for(const a in F){var V;const s=F[a],c=a.endsWith("Capture"),v=((V=r==null?void 0:r[a])!==null&&V!==void 0?V:a.slice(2).toLowerCase()).slice(0,c?-7:void 0);e.useLayoutEffect(()=>{const T=f==null?void 0:f.current;if(!(!T||typeof s!="function"))return T.addEventListener(v,s,c),()=>{T.removeEventListener(v,s,c)}},[f==null?void 0:f.current,s])}e.useLayoutEffect(()=>{if(f.current===null)return;const a=new Map;for(const s in O)oe(f.current,s,O[s]),j.current.delete(s),a.set(s,O[s]);for(const[s,c]of j.current)oe(f.current,s,void 0);j.current=a})}if(typeof window=="undefined"&&(t!=null&&t.getTemplateHTML)&&(t!=null&&t.shadowRootOptions)){const{mode:a,delegatesFocus:s}=t.shadowRootOptions;p.children=[e.createElement("template",{shadowrootmode:a,shadowrootdelegatesfocus:s,dangerouslySetInnerHTML:{__html:t.getTemplateHTML(X,C)},key:"ce-la-react-ssr-template-shadow-root"}),p.children]}return e.createElement(n,_(_(_({},m),p),{},{ref:e.useCallback(a=>{f.current=a,typeof g=="function"?g(a):g!==null&&(g.current=a)},[g])}),p.children)});return w.displayName=u!=null?u:t.name,w}function oe(e,n,t){var r,u;e[n]=t,t==null&&n in((r=(u=globalThis.HTMLElement)==null?void 0:u.prototype)!==null&&r!==void 0?r:{})&&e.removeAttribute(n)}var Pe=Ae({react:pe.default,tagName:"twitch-video",elementClass:_e,toAttributeName(e){return e==="muted"?"":e==="defaultMuted"?"muted":ue(e)}});export{Pe as default};

//# sourceMappingURL=react-DRnz1OaC.js.map