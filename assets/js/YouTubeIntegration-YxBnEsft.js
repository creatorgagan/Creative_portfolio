import"./rolldown-runtime-CzF6_L4l.js";import{a as E,c as P,i as R,l as L,o as x,r as N,s as M,u as K}from"./admin-components-D24Ek_cO.js";var y=K();L();var T="https://www.googleapis.com/youtube/v3",F="AIzaSyCaByV0M56N3NuRVm-K3Cv-EJIpfExh8RA",j=class extends Error{constructor(e,s,r){super(s),P(this,"code",void 0),P(this,"details",void 0),this.name="YouTubeAPIError",this.code=e,this.details=r}},A=class{constructor(e){P(this,"apiKey",void 0),this.apiKey=e||F}fetchPlaylist(e){var s=this;return E(function*(){if(!s.apiKey)throw new Error("YouTube API key is required");try{const r=yield fetch(`${T}/playlists?part=snippet&id=${e}&key=${s.apiKey}`);if(!r.ok)throw new j(r.status,`Failed to fetch playlist: ${r.statusText}`);const a=yield r.json();if(!a.items||a.items.length===0)throw new Error("Playlist not found");const o=a.items[0],n=yield fetch(`${T}/playlistItems?part=snippet&playlistId=${e}&maxResults=50&key=${s.apiKey}`);if(!n.ok)throw new j(n.status,`Failed to fetch playlist videos: ${n.statusText}`);const u=yield n.json(),h=u.items.map(d=>d.snippet.resourceId.videoId).join(","),c=yield fetch(`${T}/videos?part=contentDetails,statistics&id=${h}&key=${s.apiKey}`),m=c.ok?yield c.json():{items:[]},l=u.items.map((d,p)=>{var f,i,v,g,w,k,D;const C=d.snippet.resourceId.videoId,b=(f=m.items)===null||f===void 0?void 0:f.find(S=>S.id===C);return{videoId:C,title:d.snippet.title,description:d.snippet.description||"",thumbnail:((i=d.snippet.thumbnails)===null||i===void 0||(i=i.maxres)===null||i===void 0?void 0:i.url)||((v=d.snippet.thumbnails)===null||v===void 0||(v=v.high)===null||v===void 0?void 0:v.url)||((g=d.snippet.thumbnails)===null||g===void 0||(g=g.medium)===null||g===void 0?void 0:g.url)||((w=d.snippet.thumbnails)===null||w===void 0||(w=w.default)===null||w===void 0?void 0:w.url)||"",publishedAt:new Date(d.snippet.publishedAt),duration:(b==null||(k=b.contentDetails)===null||k===void 0?void 0:k.duration)||"PT0S",viewCount:parseInt((b==null||(D=b.statistics)===null||D===void 0?void 0:D.viewCount)||"0",10)}});return{playlistId:e,title:o.snippet.title,description:o.snippet.description||"",videos:l}}catch(r){throw r instanceof j?r:r instanceof Error?new Error(`YouTube API error: ${r.message}`):new Error(`YouTube API error: ${r}`)}})()}fetchVideo(e){var s=this;return E(function*(){if(!s.apiKey)throw new Error("YouTube API key is required");try{var r,a,o,n,u,h;const c=yield fetch(`${T}/videos?part=snippet,contentDetails,statistics&id=${e}&key=${s.apiKey}`);if(!c.ok)throw new j(c.status,`Failed to fetch video: ${c.statusText}`);const m=yield c.json();if(!m.items||m.items.length===0)throw new Error("Video not found");const l=m.items[0];return{videoId:e,title:l.snippet.title,description:l.snippet.description||"",thumbnail:((r=l.snippet.thumbnails)===null||r===void 0||(r=r.maxres)===null||r===void 0?void 0:r.url)||((a=l.snippet.thumbnails)===null||a===void 0||(a=a.high)===null||a===void 0?void 0:a.url)||((o=l.snippet.thumbnails)===null||o===void 0||(o=o.medium)===null||o===void 0?void 0:o.url)||((n=l.snippet.thumbnails)===null||n===void 0||(n=n.default)===null||n===void 0?void 0:n.url)||"",publishedAt:new Date(l.snippet.publishedAt),duration:((u=l.contentDetails)===null||u===void 0?void 0:u.duration)||"PT0S",viewCount:parseInt(((h=l.statistics)===null||h===void 0?void 0:h.viewCount)||"0",10)}}catch(c){throw c instanceof j?c:c instanceof Error?new Error(`YouTube API error: ${c.message}`):new Error(`YouTube API error: ${c}`)}})()}convertToVideoItem(e,s=N.OTHER){return{id:`youtube-${e.videoId}`,title:e.title,description:e.description,thumbnail:e.thumbnail,videoUrl:`https://www.youtube.com/watch?v=${e.videoId}`,youtubeId:e.videoId,category:s,tags:this.extractTagsFromDescription(e.description),createdDate:e.publishedAt,featured:!1,duration:this.parseDuration(e.duration),viewCount:e.viewCount}}convertPlaylistToVideoItems(e,s=N.OTHER){return e.videos.map(r=>this.convertToVideoItem(r,s))}parseDuration(e){const s=e.match(/PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?/);if(!s)return 0;const r=parseInt(s[1]||"0",10),a=parseInt(s[2]||"0",10),o=parseInt(s[3]||"0",10);return r*3600+a*60+o}extractTagsFromDescription(e){const s=[],r=e.match(/#[\w]+/g);return r&&s.push(...r.map(a=>a.substring(1).toLowerCase())),["commercial","music video","documentary","short film","wedding","corporate","event","promotional","cinematic"].forEach(a=>{e.toLowerCase().includes(a)&&s.push(a.replace(" ","-"))}),[...new Set(s)]}static getThumbnailUrl(e,s="high"){return{maxres:e.thumbnail,high:e.thumbnail,medium:e.thumbnail,default:e.thumbnail}[s]||e.thumbnail}static formatViewCount(e){return e>=1e9?`${(e/1e9).toFixed(1)}B views`:e>=1e6?`${(e/1e6).toFixed(1)}M views`:e>=1e3?`${(e/1e3).toFixed(1)}K views`:`${e} views`}static formatDuration(e){const s=Math.floor(e/3600),r=Math.floor(e%3600/60),a=e%60;return s>0?`${s}:${r.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`:`${r}:${a.toString().padStart(2,"0")}`}};const I=new A,Y=e=>{if(e instanceof j)switch(e.code){case 400:return"Invalid request. Please check the video or playlist ID.";case 403:return"Access forbidden. Please check your API key permissions.";case 404:return"Video or playlist not found.";case 429:return"Too many requests. Please try again later.";default:return`YouTube API error: ${e.message}`}return e instanceof Error?e.message:"An unexpected error occurred while fetching YouTube data."};M();const V=e=>{const[s,r]=(0,y.useState)({playlist:null,videos:[],loading:!1,error:null}),[a,o]=(0,y.useState)(e),n=(0,y.useCallback)((function(){var m=E(function*(l,d=N.OTHER){r(p=>x(x({},p),{},{loading:!0,error:null})),o(l);try{const p=yield I.fetchPlaylist(l),f=I.convertPlaylistToVideoItems(p,d);r(i=>x(x({},i),{},{playlist:p,videos:f,loading:!1,error:null}))}catch(p){const f=Y(p);r(i=>x(x({},i),{},{loading:!1,error:f}))}});return function(l){return m.apply(this,arguments)}})(),[]),u=(0,y.useCallback)((function(){var m=E(function*(l,d=N.OTHER){try{const p=yield I.fetchVideo(l);return I.convertToVideoItem(p,d)}catch(p){const f=Y(p);return r(i=>x(x({},i),{},{error:f})),null}});return function(l){return m.apply(this,arguments)}})(),[]),h=(0,y.useCallback)(()=>{r(m=>x(x({},m),{},{error:null}))},[]),c=(0,y.useCallback)(()=>{a&&n(a)},[a,n]);return(0,y.useEffect)(()=>{e&&!s.playlist&&!s.loading&&n(e)},[e,n,s.playlist,s.loading]),x(x({},s),{},{fetchPlaylist:n,fetchVideo:u,clearError:h,retry:c})};var t=R(),_=({playlistId:e,category:s=N.OTHER,maxVideos:r=10,showMetadata:a=!0,onVideoSelect:o,className:n=""})=>{const{playlist:u,videos:h,loading:c,error:m,fetchPlaylist:l,clearError:d,retry:p}=V();(0,y.useEffect)(()=>{e&&l(e,s)},[e,s,l]);const f=r?h.slice(0,r):h;return c?(0,t.jsx)("div",{className:`flex items-center justify-center p-8 ${n}`,children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Loading YouTube content..."})]})}):m?(0,t.jsx)("div",{className:`bg-red-50 border border-red-200 rounded-lg p-6 ${n}`,children:(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,t.jsxs)("div",{className:"ml-3 flex-1",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"YouTube Integration Error"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-red-700",children:m}),(0,t.jsxs)("div",{className:"mt-4 flex space-x-3",children:[(0,t.jsx)("button",{onClick:p,className:"bg-red-100 hover:bg-red-200 text-red-800 px-3 py-1 rounded text-sm font-medium transition-colors",children:"Retry"}),(0,t.jsx)("button",{onClick:d,className:"text-red-600 hover:text-red-500 text-sm font-medium",children:"Dismiss"})]})]})]})}):!u||h.length===0?(0,t.jsxs)("div",{className:`text-center p-8 text-gray-500 ${n}`,children:[(0,t.jsx)("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),(0,t.jsx)("p",{children:"No YouTube videos found"}),e&&(0,t.jsxs)("p",{className:"text-sm mt-2",children:['Check that the playlist ID "',e,'" is correct and public']})]}):(0,t.jsxs)("div",{className:n,children:[u&&a&&(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:u.title}),u.description&&(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:u.description}),(0,t.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,t.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{d:"M2 6a2 2 0 012-2h6l2 2h6a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"})}),(0,t.jsxs)("span",{children:[h.length," videos"]}),(0,t.jsx)("span",{className:"mx-2",children:"â€¢"}),(0,t.jsx)("a",{href:`https://www.youtube.com/playlist?list=${u.playlistId}`,target:"_blank",rel:"noopener noreferrer",className:"text-red-600 hover:text-red-700 font-medium",children:"View on YouTube"})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(i=>(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>o==null?void 0:o(i),children:[(0,t.jsxs)("div",{className:"relative aspect-video bg-gray-200",children:[(0,t.jsx)("img",{src:i.thumbnail,alt:i.title,className:"w-full h-full object-cover",loading:"lazy"}),i.duration&&(0,t.jsx)("div",{className:"absolute bottom-2 right-2 bg-black bg-opacity-75 text-white text-xs px-2 py-1 rounded",children:A.formatDuration(i.duration)}),(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity bg-black bg-opacity-30",children:(0,t.jsx)("div",{className:"w-16 h-16 bg-red-600 rounded-full flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-8 h-8 text-white ml-1",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})})})})]}),(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 mb-2 line-clamp-2",children:i.title}),a&&(0,t.jsxs)(t.Fragment,{children:[i.description&&(0,t.jsx)("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:i.description}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[i.viewCount&&(0,t.jsx)("span",{children:A.formatViewCount(i.viewCount)}),(0,t.jsx)("span",{className:"capitalize",children:i.category.replace(/_/g," ")})]}),i.createdDate&&(0,t.jsx)("span",{children:new Date(i.createdDate).toLocaleDateString()})]}),i.tags.length>0&&(0,t.jsx)("div",{className:"mt-3 flex flex-wrap gap-1",children:i.tags.slice(0,3).map((v,g)=>(0,t.jsxs)("span",{className:"bg-gray-100 text-gray-600 text-xs px-2 py-1 rounded",children:["#",v]},g))})]})]})]},i.id))}),r&&h.length>r&&(0,t.jsx)("div",{className:"text-center mt-8",children:(0,t.jsxs)("button",{onClick:()=>{},className:"bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg font-medium transition-colors",children:["View All ",h.length," Videos"]})})]})},q=_;export{q as default};

//# sourceMappingURL=YouTubeIntegration-YxBnEsft.js.map