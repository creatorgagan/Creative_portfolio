import{r as N}from"./rolldown-runtime-CzF6_L4l.js";import{a as $,c as A,l as j,o as S,s as F,u as G}from"./admin-components-D24Ek_cO.js";import{l as V}from"./react-vendor-BSVagTro.js";import{t as g}from"./hls-DJPxqd7n.js";import{a as z,i as O,n as k,r as H,t as x}from"./classPrivateFieldSet2-DTU-rhuG.js";import{n as Y,t as q}from"./dist-BvFLEbdi.js";var J=N(G(),1);F();j();var U=["src"],K=t=>{var y,o,v,E,b;return o=new WeakMap,v=new WeakMap,E=new WeakSet,b=new WeakMap,y=class extends t{constructor(){super(),z(this,E),O(this,o,null),O(this,v,null),O(this,b,()=>{var e,h,c;(e=this.nativeEl)!=null&&e.webkitCurrentPlaybackTargetIsWireless?(h=this.api)==null||h.stopLoad():(c=this.api)==null||c.startLoad()}),H(E,this,I).call(this,"config")}get config(){return k(v,this)}set config(e){x(v,this,e)}attributeChangedCallback(e,h,c){e!=="src"&&super.attributeChangedCallback(e,h,c),e==="src"&&h!=c&&this.load()}load(){var e=this;return $(function*(){var h,c;const P=!e.api;if(H(E,e,M).call(e),!!e.src){if(P&&!k(v,e)&&x(v,e,JSON.parse(((h=e.shadowRoot.getElementById("config"))==null?void 0:h.textContent)||"{}")),g.isSupported()){switch(yield Promise.resolve(),e.api=new g(S({liveDurationInfinity:!0,autoStartLoad:!1},e.config)),e.api.loadSource(e.src),e.api.attachMedia(e.nativeEl),e.nativeEl.preload){case"none":{const s=()=>e.api.startLoad();e.nativeEl.addEventListener("play",s,{once:!0}),e.api.on(g.Events.DESTROYING,()=>{e.nativeEl.removeEventListener("play",s)});break}case"metadata":{const s=e.api.config.maxBufferLength,i=e.api.config.maxBufferSize;e.api.config.maxBufferLength=1,e.api.config.maxBufferSize=1;const a=()=>{e.api.config.maxBufferLength=s,e.api.config.maxBufferSize=i};e.nativeEl.addEventListener("play",a,{once:!0}),e.api.on(g.Events.DESTROYING,()=>{e.nativeEl.removeEventListener("play",a)}),e.api.startLoad();break}default:e.api.startLoad()}e.nativeEl.webkitCurrentPlaybackTargetIsWireless&&e.api.stopLoad(),e.nativeEl.addEventListener("webkitcurrentplaybacktargetiswirelesschanged",k(b,e)),x(o,e,document.createElement("source")),k(o,e).setAttribute("type","application/x-mpegURL"),k(o,e).setAttribute("src",e.src),e.nativeEl.disableRemotePlayback=!1,e.nativeEl.append(k(o,e));const L=new WeakMap;e.api.on(g.Events.MANIFEST_PARSED,(s,i)=>{e.nativeEl.autoplay&&e.nativeEl.paused&&e.nativeEl.play().catch(l=>{console.warn("Autoplay failed:",l)}),_();let a=e.videoTracks.getTrackById("main");a||(a=e.addVideoTrack("main"),a.id="main",a.selected=!0);for(const[l,d]of i.levels.entries()){const p=a.addRendition(d.url[0],d.width,d.height,d.videoCodec,d.bitrate);L.set(d,`${l}`),p.id=`${l}`}for(let[l,d]of i.audioTracks.entries()){const p=d.default?"main":"alternative",n=e.addAudioTrack(p,d.name,d.lang);n.id=`${l}`,d.default&&(n.enabled=!0)}}),e.audioTracks.addEventListener("change",()=>{var s;const i=+((s=[...e.audioTracks].find(l=>l.enabled))==null?void 0:s.id),a=e.api.audioTracks.map(l=>l.id);i!=e.api.audioTrack&&a.includes(i)&&(e.api.audioTrack=i)}),e.api.on(g.Events.LEVELS_UPDATED,(s,i)=>{var a;const l=e.videoTracks[(a=e.videoTracks.selectedIndex)!==null&&a!==void 0?a:0];if(!l)return;const d=i.levels.map(p=>L.get(p));for(const p of e.videoRenditions)p.id&&!d.includes(p.id)&&l.removeRendition(p)});let f=null;e.api.on(g.Events.ERROR,(s,i)=>{i.type===g.ErrorTypes.NETWORK_ERROR&&i.details===g.ErrorDetails.FRAG_LOAD_ERROR&&(f=i.frag.level)}),e.api.on(g.Events.LEVEL_SWITCHED,(s,i)=>{const a=i.level;f!==null&&a<f&&(console.warn(`⚠️ hls.js downgraded quality from level ${f} to ${a} due to fragment load failure.`),e.videoRenditions.selectedIndex=a,f=null)});const w=s=>{const i=s.target.selectedIndex;i!=e.api.nextLevel&&(e.api.nextLevel=i)};(c=e.videoRenditions)==null||c.addEventListener("change",w);const _=()=>{for(const s of e.videoTracks)e.removeVideoTrack(s);for(const s of e.audioTracks)e.removeAudioTrack(s)};e.api.once(g.Events.DESTROYING,_);return}yield Promise.resolve(),e.nativeEl.canPlayType("application/vnd.apple.mpegurl")&&(e.nativeEl.src=e.src)}})()}},A(y,"shadowRootOptions",S({},t.shadowRootOptions)),A(y,"getTemplateHTML",(u,e={})=>{const{src:h}=u,c=V(u,U);return`
        <script type="application/json" id="config">
          ${JSON.stringify(e.config||{})}
        <\/script>
        ${t.getTemplateHTML(c)}
      `}),y;function M(){var u,e;(u=k(o,this))==null||u.remove(),(e=this.nativeEl)==null||e.removeEventListener("webkitcurrentplaybacktargetiswirelesschanged",k(b,this)),this.api&&(this.api.detachMedia(),this.api.destroy(),this.api=null)}function I(u){if(Object.prototype.hasOwnProperty.call(this,u)){const e=this[u];delete this[u],this[u]=e}}},B=K(q(Y));globalThis.customElements&&!globalThis.customElements.get("hls-video")&&globalThis.customElements.define("hls-video",B);var Q=B;F();var X=new Set(["style","children","ref","key","suppressContentEditableWarning","suppressHydrationWarning","dangerouslySetInnerHTML"]),Z={className:"class",htmlFor:"for"};function D(t){return t.toLowerCase()}function W(t){if(typeof t=="boolean")return t?"":void 0;if(typeof t!="function"&&!(typeof t=="object"&&t!==null))return t}function ee({react:t,tagName:y,elementClass:o,events:v,displayName:E,defaultProps:b,toAttributeName:M=D,toAttributeValue:I=W}){const u=Number.parseInt(t.version)>=19,e=t.forwardRef((h,c)=>{var P,L;const f=t.useRef(null),w=t.useRef(new Map),_={},s={},i={},a={};for(const[n,r]of Object.entries(h)){var l,d;if(X.has(n)){i[n]=r;continue}const m=M((l=Z[n])!==null&&l!==void 0?l:n);if(o.prototype&&n in o.prototype&&!(n in((d=(P=globalThis.HTMLElement)==null?void 0:P.prototype)!==null&&d!==void 0?d:{}))&&!((L=o.observedAttributes)!=null&&L.some(R=>R===m))){a[n]=r;continue}if(n.startsWith("on")){_[n]=r;continue}const T=I(r);m&&T!=null&&(s[m]=String(T),u||(i[m]=T)),m&&u&&(T!==W(r)?i[m]=T:i[m]=r)}if(typeof window!="undefined"){for(const n in _){var p;const r=_[n],m=n.endsWith("Capture"),T=((p=v==null?void 0:v[n])!==null&&p!==void 0?p:n.slice(2).toLowerCase()).slice(0,m?-7:void 0);t.useLayoutEffect(()=>{const R=f==null?void 0:f.current;if(!(!R||typeof r!="function"))return R.addEventListener(T,r,m),()=>{R.removeEventListener(T,r,m)}},[f==null?void 0:f.current,r])}t.useLayoutEffect(()=>{if(f.current===null)return;const n=new Map;for(const r in a)C(f.current,r,a[r]),w.current.delete(r),n.set(r,a[r]);for(const[r,m]of w.current)C(f.current,r,void 0);w.current=n})}if(typeof window=="undefined"&&(o!=null&&o.getTemplateHTML)&&(o!=null&&o.shadowRootOptions)){const{mode:n,delegatesFocus:r}=o.shadowRootOptions;i.children=[t.createElement("template",{shadowrootmode:n,shadowrootdelegatesfocus:r,dangerouslySetInnerHTML:{__html:o.getTemplateHTML(s,h)},key:"ce-la-react-ssr-template-shadow-root"}),i.children]}return t.createElement(y,S(S(S({},b),i),{},{ref:t.useCallback(n=>{f.current=n,typeof c=="function"?c(n):c!==null&&(c.current=n)},[c])}),i.children)});return e.displayName=E!=null?E:o.name,e}function C(t,y,o){var v,E;t[y]=o,o==null&&y in((v=(E=globalThis.HTMLElement)==null?void 0:E.prototype)!==null&&v!==void 0?v:{})&&t.removeAttribute(y)}var le=ee({react:J.default,tagName:"hls-video",elementClass:Q,toAttributeName(t){return t==="muted"?"":t==="defaultMuted"?"muted":D(t)}});export{le as default};

//# sourceMappingURL=react-B7N-HUp6.js.map